Selecting employees from a certain period:

SELECT *
FROM employees
where employees.startdate <= '2008-07-01'
and (employees.enddate >= '2008-07-01'
    OR
    employees.enddate is NULL)
   
   
   
Employee counts by date key:

SELECT  DATE_TRUNC(dates.datekey, 'month') as mt, COUNT(1)
FROM employees cross join dates
where dates.datekey >= employees.startdate 
and (dates.datekey <= employees.enddate
    OR
    employees.enddate is NULL)
group by DATE_TRUNC(dates.datekey, 'month')
order by DATE_TRUNC(dates.datekey, 'month')

